<script setup>
import {
  ref, reactive, onMounted,
} from 'vue';
import { register } from 'swiper/element/bundle';

import AppCover from './pageItem/AppCover.vue';
import SaveTheDate from './pageItem/SaveTheDate.vue';
import ParkInyoung from './pageItem/ParkInyoung.vue';
import LeeSuhyun from './pageItem/LeeSuhyun.vue';
import Invitation from './pageItem/InvitationPage.vue';
import Location from './pageItem/LocationPage.vue';
import Gallery from './pageItem/GalleryPage.vue';
import Regards from './pageItem/RegardsPage.vue';

import location from '@/assets/images/location.svg';

register();

const swiperContainer = ref(null);

const state = reactive({
  activeSlide: 0,
  totalSlide: 0,
});

onMounted(() => {
  Object.assign(swiperContainer.value, {
    creativeEffect: {
      prev: {
        shadow: true,
        translate: [0, '-20%', -1],
      },
      next: {
        translate: [0, '100%', 0],
      },
    },
  });

  swiperContainer.value.initialize();
});

const swipeDown = () => {
  swiperContainer.value.swiper.slideNext();
};

const swipeToMap = () => {
  swiperContainer.value.swiper.slideTo(5, 500);
};

const onInit = () => {
  state.totalSlide = swiperContainer.value?.swiper.slides.length;
};

const onSlideChange = () => {
  state.activeSlide = swiperContainer.value.swiper.activeIndex + 1;
};
</script>

<template>
  <swiper-container
    ref="swiperContainer"
    class="swiperContainer"
    :pagination="false"
    direction="vertical"
    :mousewheel="true"
    :init="false"
    effect="creative"
    @init="onInit"
    @slidechange="onSlideChange"
  >
    <div v-if="state.activeSlide !== 0 && state.activeSlide !== 5" class="navigation">
      <div class="left">
        {{ state.activeSlide }} / {{ state.totalSlide }}
      </div>
      <div class="right">
        <v-btn
          rounded
          variant="outlined"
          @click="swipeToMap"
        >
          <template #prepend>
            <img :src="location" alt="location">
          </template>
          위치보기
        </v-btn>
      </div>
    </div>

    <swiper-slide class="swiperSlide">
      <AppCover @down-arrow-click="swipeDown" />
    </swiper-slide>

    <swiper-slide class="swiperSlide">
      <SaveTheDate />
    </swiper-slide>

    <swiper-slide class="swiperSlide">
      <ParkInyoung />
    </swiper-slide>

    <swiper-slide class="swiperSlide">
      <LeeSuhyun />
    </swiper-slide>

    <swiper-slide class="swiperSlide">
      <Invitation />
    </swiper-slide>

    <swiper-slide class="swiperSlide">
      <Location />
    </swiper-slide>

    <swiper-slide class="swiperSlide">
      <Gallery />
    </swiper-slide>

    <swiper-slide class="swiperSlide">
      <Regards />
    </swiper-slide>
  </swiper-container>
</template>

<style lang="scss" scoped>
.swiperContainer {
  width: 100%;
  height: 100%;
}

.swiperSlide {
  text-align: center;
  font-size: 18px;
  background: #fff;
  display: flex;
  justify-content: center;
  align-items: center;
}

.navigation {
  position: absolute;
  z-index: 50;
  width: calc(100% - 40px);
  padding: 0 20px;
  top: 20px;

  display: flex;
  justify-content: space-between;

  color: var(--color-text-beige);

  .left {
    margin-left: 12px;

    font-family: 'Noto Sans KR';
    font-style: normal;
    font-weight: 500;
    font-size: 14px;
    line-height: 200%;
  }
}
</style>
